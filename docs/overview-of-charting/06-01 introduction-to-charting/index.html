<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/excel-vba-book/blog/rss.xml" title="Excel VBA Book RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/excel-vba-book/blog/atom.xml" title="Excel VBA Book Atom Feed"><title data-react-helmet="true">06-01 introduction-to-charting | Excel VBA Book</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://your-docusaurus-test-site.com/excel-vba-book/docs/overview-of-charting/06-01 introduction-to-charting"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="06-01 introduction-to-charting | Excel VBA Book"><meta data-react-helmet="true" name="description" content="introduction to charting"><meta data-react-helmet="true" property="og:description" content="introduction to charting"><link data-react-helmet="true" rel="icon" href="/excel-vba-book/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://your-docusaurus-test-site.com/excel-vba-book/docs/overview-of-charting/06-01 introduction-to-charting"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/excel-vba-book/docs/overview-of-charting/06-01 introduction-to-charting" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://your-docusaurus-test-site.com/excel-vba-book/docs/overview-of-charting/06-01 introduction-to-charting" hreflang="x-default"><link rel="stylesheet" href="/excel-vba-book/assets/css/styles.d9d837ef.css">
<link rel="preload" href="/excel-vba-book/assets/js/runtime~main.1159a31f.js" as="script">
<link rel="preload" href="/excel-vba-book/assets/js/main.1302b3df.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/excel-vba-book/"><div class="navbar__logo"><img src="/excel-vba-book/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/excel-vba-book/img/logo.svg" alt="My Site Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Excel VBA Book</b></a><a class="navbar__item navbar__link navbar__link--active" href="/excel-vba-book/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/excel-vba-book/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/excel-vba-book/docs/cheat-sheets/01 cheat-sheets">cheat-sheets</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/excel-vba-book/docs/overview-of-intro-overview/02 overview-of-intro-overview">overview-of-intro-overview</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/excel-vba-book/docs/overview-of-basics-of-VBA/03 overview-of-basics-of-VBA">overview-of-basics-of-VBA</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/excel-vba-book/docs/summary-of-Selections/04 summary-of-Selections">summary-of-Selections</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/excel-vba-book/docs/overview-of-values-and-formulas/05 overview-of-values-and-formulas">overview-of-values-and-formulas</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/excel-vba-book/docs/overview-of-charting/06 overview-of-charting">overview-of-charting</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06 overview-of-charting">overview of charting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-01 introduction-to-charting">06-01 introduction-to-charting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-02 common-objectsproperties-for-a-Chart">06-02 common-objectsproperties-for-a-Chart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-03 creating-charts-from-scratch">06-03 creating-charts-from-scratch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-04 specific-charting-examples">06-04 specific-charting-examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-05 ChartAddTitlesmd">06-05 ChartAddTitlesmd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-06 ChartApplyFormattingToSelectedmd">06-06 ChartApplyFormattingToSelectedmd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-07 ChartApplyTrendColorsmd">06-07 ChartApplyTrendColorsmd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-08 ChartCreateChartWithSeriesForEachColumnmd">06-08 ChartCreateChartWithSeriesForEachColumnmd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-09 ChartCreateDataLabelsmd">06-09 ChartCreateDataLabelsmd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-10 ChartExtendSeriesToRangesmd">06-10 ChartExtendSeriesToRangesmd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-11 ChartGoToXRangemd">06-11 ChartGoToXRangemd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-12 ChartSortSeriesByNamemd">06-12 ChartSortSeriesByNamemd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-13 ChartFlipXYValuesmd">06-13 ChartFlipXYValuesmd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-14 ChartMergeSeriesmd">06-14 ChartMergeSeriesmd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-15 ChartSplitSeriesmd">06-15 ChartSplitSeriesmd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-16 DeleteAllChartsmd">06-16 DeleteAllChartsmd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-17 RemoveZeroValueDataLabelmd">06-17 RemoveZeroValueDataLabelmd</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/excel-vba-book/docs/overview-of-charting/06-18 UpdateFromChartSeriesmd">06-18 UpdateFromChartSeriesmd</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/excel-vba-book/docs/The-Worksheet-object/07 The-Worksheet-object">The-Worksheet-object</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/excel-vba-book/docs/The-Workbook-object/08 The-Workbook-object">The-Workbook-object</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/excel-vba-book/docs/The-Application-object/09 The-Application-object">The-Application-object</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/excel-vba-book/docs/overview-of-adv-processing/10 overview-of-adv-processing">overview-of-adv-processing</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/excel-vba-book/docs/overview-of-events/11 overview-of-events">overview-of-events</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/excel-vba-book/docs/overview-of-user-forms-and-input/12 overview-of-user-forms-and-input">overview-of-user-forms-and-input</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/excel-vba-book/docs/overview-of-UDFs/13 overview-of-UDFs">overview-of-UDFs</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/excel-vba-book/docs/overview-of-building-an-addin/14 overview-of-building-an-addin">overview-of-building-an-addin</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/excel-vba-book/docs/overview-of-utility-code/15 overview-of-utility-code">overview-of-utility-code</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/excel-vba-book/docs/intro">intro</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>06-01 introduction-to-charting</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="introduction-to-charting">introduction to charting<a class="hash-link" href="#introduction-to-charting" title="Direct link to heading">â€‹</a></h2><p>Charting is the second most important aspect of automatic Excel behind manipulating <code>Ranges</code>. There is a bias when saying that because a lot of what I do after engineering calculations is chart the results. In particular, Excel can be used to great effect to chart time series of data. The other reason charts are so amenable to VBA is that very often you are applying the same actions to the charts. In that sense, the VBA related to charts is doing a lot of changing settings and formats so that the charts look the way you want. This ahs the immediate effect of making your charts look less like &quot;they came from Excel&quot; which is a common knock in some circles.</p><p>When working with <code>Charts</code>, there is a <code>Range</code> of difficulties depending on what you are trying to do. In some cases, working with an existing <code>chart</code> is much easier than creating a new one. In other instances, it can be much simpler to create a new chart, starting from a default, rather than change all the settings back. One other major difference between <code>Charts</code> and <code>Ranges</code> is that working with charts is much more about knowing the object model than knowing how to program. The vast majority of your code related to charts is simply iterating through objects to find the one property that you want to change. This makes it easier to write chart VBA once you have the basics of <code>For Each</code> loops down. It also means that you need to spend some time getting comfortable with the object model.</p><p>There is one oddity related to Charts that is worth mentioning now. Charts can either be embedded as an object on a <code>Worksheet</code>, or they can be their own <code>Sheets</code>. I personally never use the latter case, but it is common enough that it needs to be on your mind when working with Charting code.</p><p>(I don&#x27;t use the Chart as a Sheet model because I find that it is not necessary in terms of displaying data. In particular, you are at the mercy of your window size and cannot easily change the dimensions. Also, it complicates the VBA side of things to work in both formats all the time, so I just decided to always put my Charts on Sheets. Your mileage may vary so I&#x27;ll touch on both approaches in the code samples.)</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="a-quick-overview-of-the-object-model">a quick overview of the object model<a class="hash-link" href="#a-quick-overview-of-the-object-model" title="Direct link to heading">â€‹</a></h3><ul><li><code>ChartObjects</code> -&gt; <code>ChartObject</code> - this derives from <code>Shape</code> and exists when the Chart is on a Worksheet<ul><li><code>Chart</code><ul><li><code>SeriesCollection</code> -&gt; <code>Series</code></li><li><code>Axes</code> -&gt; <code>Axis</code></li><li><code>ChartArea</code></li><li><code>PlotArea</code></li></ul></li></ul></li><li><code>ActiveChart</code> -&gt; <code>Chart</code> - this works whether you have a Worksheet or Chart on a sheet</li><li><code>Selection</code> -&gt; <code>Variant</code> - this one can be useful but is often not of the type that you want.</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="obtaining-a-reference-to-a-chart">obtaining a reference to a Chart<a class="hash-link" href="#obtaining-a-reference-to-a-chart" title="Direct link to heading">â€‹</a></h3><p>When working with <code>Charts</code>, the first task is typically to get a reference to an existing chart -- unless you are creating a new chart. To obtain a reference to a chart, there are a handful of ways of doing it depending on what your spreadsheet contains and how it&#x27;s structured.</p><p>THe main ways to do it are:</p><ul><li>Use the <code>ActiveChart</code> object</li><li>Use the <code>Selection</code> object -- this is highly depending on what is selected</li><li>Use the <code>ChartObjects</code> object<ul><li>If you know which chart you want, you can supply an index; this works great if there is only a single chart - <code>ChartObjects(1)</code></li><li>If you want to do something to all charts, you can iterate this object</li><li>If you have named the chart (more on that later) you can supply the name as the index - <code>ChartObjects(&quot;SomeChart&quot;)</code></li></ul></li><li>The <code>Workbook.Sheets</code> object if your charts are contained in their own sheets<ul><li>Same as above, you can access via a numeric index, name, or iterate through all of them</li></ul></li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="activechart"><code>ActiveChart</code><a class="hash-link" href="#activechart" title="Direct link to heading">â€‹</a></h4><p><code>ActiveChart</code> is similar to the other <code>Active</code> objects in that it does about what you expect. The one difference is that the Chart actually has to be selected or have focus in order to be considered &quot;active&quot;. This is similar but also different to something like <code>ActiveWorkbook</code> where having the workbook open makes it active.</p><p>Note that <code>ActiveChart</code> will work for a <code>Chart</code> that is contained on a Worksheet or also for one that is its own Sheet. If the latter case, then <code>ActiveSheet</code> and <code>ActiveChart</code> will refer to the same object. Side note: this technicality is why you will not get proper Intellisense when using <code>ActiveSheet</code> -- that Sheet could technically be a Chart.</p><p>The nice thing about <code>ActiveChart</code> is that it gives you the Chart object which then gives you immediate access to the Chart related details you are like to want to change. The downside is that unless you have a single Chart that is already selected, <code>ActiveChart</code> has limited application when using VBA. Again, the goal is to avoid selecting objects in order to access them via VBA so <code>ActiveChart</code> is not ideal.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="selection"><code>Selection</code><a class="hash-link" href="#selection" title="Direct link to heading">â€‹</a></h4><p>The Selection object is probably the greatest catch all for an object. It literally holds anything, and this means that using the object requires knowing what is selected, or checking vigorously before using the object. Technically, you also let your code error out if the wrong object is selected, and this works well at times. This works well because you are unlikely to be using <code>Selection</code> in a complicated workflow because, again, you should not be selecting objects to access them. This means that <code>Selection</code> is really limited to one-off and helper code where you can more tightly dictate that this code only works if you select a Chart. You should still add some error handling, but sometimes that step is skipped.</p><p>Since the <code>Selection</code> can hold anything, it&#x27;s important to know what could be Selected. Related to charts, the following can all live in the <code>Selection</code>:</p><ul><li><code>ChartObjects</code></li><li><code>Chart</code></li><li><code>ChartArea</code></li><li><code>PlotArea</code></li><li><code>Legend</code></li><li><code>ChartTitle</code></li><li><code>Series</code></li></ul><p>If you are writing VBA to work on Charts, you can technically require the user to select the correct part of the chart and always use <code>Selection</code>. You will quickly grow tired of having to remember which part of the Chart to select in order to make the code work. To avoid this scenario, it is helpful to remember the object model and know how to work your way around a Chart.</p><p>My approach has always been to convert the <code>Selection</code> to a Collection of <code>ChartObjects</code>. I can then always iterate that resulting Collection to process the Charts. If only a single Chart was selected, the code works all the same. The downside to this approach is that a Chart as a Sheet cannot live inside a ChartObject. This is a large part of why I always put Charts on a Worksheet.</p><p>Below is the helper function I use in order to convert a possibly Chart containing selection into a Collection of <code>ChartObjects</code>. It works for all objects except for the Axis related ones.</p><p>TODO: consider improving this code if it is included as a de facto reference</p><div class="codeBlockContainer_J+bg language-vb theme-code-block"><div class="codeBlockContent_csEI vb"><pre tabindex="0" class="prism-code language-vb codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">Public Function Chart_GetObjectsFromObject(ByVal inputObject As Object) As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim chartObjectCollection As New Collection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;NOTE that this function does not work well with Axis objects.  Excel does not return the correct Parent for them.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim targetObject As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim inputObjectType As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    inputObjectType = TypeName(inputObject)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Select Case inputObjectType</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Case &quot;DrawingObjects&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;this means that multiple charts are selected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            For Each targetObject In inputObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                If TypeName(targetObject) = &quot;ChartObject&quot; Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &#x27;add it to the set</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    chartObjectCollection.Add targetObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Next targetObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Case &quot;Worksheet&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            For Each targetObject In inputObject.ChartObjects</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                chartObjectCollection.Add targetObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Next targetObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Case &quot;Chart&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            chartObjectCollection.Add inputObject.Parent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Case &quot;ChartArea&quot;, &quot;PlotArea&quot;, &quot;Legend&quot;, &quot;ChartTitle&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;parent is the chart, parent of that is the chart targetObject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            chartObjectCollection.Add inputObject.Parent.Parent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Case &quot;Series&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;need to go up three levels</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            chartObjectCollection.Add inputObject.Parent.Parent.Parent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Case &quot;Axis&quot;, &quot;Gridlines&quot;, &quot;AxisTitle&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27;these are the oddly unsupported objects</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            MsgBox &quot;Axis/gridline selection not supported.  This is an Excel bug.  Select another element on the chart(s).&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Case Else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            MsgBox &quot;Select a part of the chart(s), except an axis.&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End Select</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Set Chart_GetObjectsFromObject = chartObjectCollection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="chartobjects">ChartObjects<a class="hash-link" href="#chartobjects" title="Direct link to heading">â€‹</a></h4><p>If you are working on a Worksheet, then that Worksheet will have the <code>ChartObjects</code> object. This object is great because it contains all of the Charts in their own collection (separate from any other Shapes or buttons). This <code>ChartObjects</code> collection contains object of type ChartObject. The ChartObject derives from Shape which means it contains all of the properties related to on-sheet position and size.</p><p>A typical workflow is included below since it is a pattern that shows up all the time in VBA code related to charts. At a high level the steps are:</p><ul><li>Use ActiveSheet or a Worksheet reference to access the <code>ChartObjects</code></li><li>Iterate through each <code>ChartObject</code>, storing a reference to the underlying Chart</li><li>You then setup sections to work through the parts of the Chart you want<ul><li>Iterate through the <code>SeriesCollection</code></li><li>Iterate through the Axes</li><li>Touch the other top level properties including <code>ChartTile</code>, <code>Legend</code>, etc.</li></ul></li></ul><p>This workflow is quite powerful because it can quickly be wrapped with a loop to go through all Worksheets and even possible all Workbooks. It&#x27;s also powerful because you can be quite comfortable learning this pattern and then adding in the parts that you actually want to change. The only downside is that it can be quite tedious to type out all the loops every time, but there&#x27;s not a good way around that other than to use the clipboard.</p><p>Another approach to using <code>ChartObjects</code> is to not iterate through all of them but instead to select a single ChartObject and work with it. There are two ways to do this:</p><ul><li>Use an integer index for the Chart -- this is quite easy to do if there are only a few charts</li><li>Name the chart and use that name</li></ul><p>When using either of these approaches, it is quite helpful to show the <code>Selection Pane</code> window in Excel. This pane will pop out and tell you the order and the names of all the objects on the sheet (this includes comments, shapes, and Charts). From this pane, you can rearrange the charts into the order you want or rename them.</p><p>Although <code>For Each</code> loops are generally preferred when working with Charts, sometimes you simply know that you want to change one chart and an index just lets you do that. If you are in the habit of using loops however, you can easily do that with the helper code included above which stick a single chart into a Collection.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="workbooksheets-to-get-chart-references">Workbook.Sheets to get Chart references<a class="hash-link" href="#workbooksheets-to-get-chart-references" title="Direct link to heading">â€‹</a></h4><p>The final approach to obtaining a Chart reference is to use the <code>Sheets</code> object. Aside from ActiveChart, this is the only way to deal with Charts that are their own Sheet. Again, you can either use an index or a Name. Here, the Name is easily changed on the Sheet tab so it&#x27;s much more common to use a Name when doing this. The other approach is to iterate through all the <code>Sheets</code> and pick off the ones that are Charts.</p><p>There are two key points when working with Charts as <code>Sheets</code>:</p><ul><li>You must use the <code>Workbook.Sheets</code> object to access them and not <code>Workbook.Worksheets</code>. The latter object contains only those <code>Worksheets</code> that are not Charts. The former contains both Charts and <code>Worksheets</code>.</li><li>It&#x27;s possible that your Sheet is not actually a Chart. You should check the type of the object if you are going to iterate through all <code>Worksheets</code>. Also be aware that some sheets can be hidden which might lead to unexpected results.</li></ul><p>TODO: is there a Charts object on Workbook?</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/06-overview-of-charting/06-01 introduction-to-charting.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/excel-vba-book/docs/overview-of-charting/06 overview-of-charting"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">overview of charting</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/excel-vba-book/docs/overview-of-charting/06-02 common-objectsproperties-for-a-Chart"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">06-02 common-objectsproperties-for-a-Chart</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction-to-charting" class="table-of-contents__link toc-highlight">introduction to charting</a><ul><li><a href="#a-quick-overview-of-the-object-model" class="table-of-contents__link toc-highlight">a quick overview of the object model</a></li><li><a href="#obtaining-a-reference-to-a-chart" class="table-of-contents__link toc-highlight">obtaining a reference to a Chart</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/excel-vba-book/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/excel-vba-book/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/excel-vba-book/assets/js/runtime~main.1159a31f.js"></script>
<script src="/excel-vba-book/assets/js/main.1302b3df.js"></script>
</body>
</html>