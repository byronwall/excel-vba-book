### the Ribbon

When using the Ribbon, there are a couple of items to consider:

- Do you want your UI to show up in an existing tab or on your own?
- How interactive do you want your UI to be? This can range from simple buttons that trigger actions to text boxes and other more interactive features that are able to detect user input and respond accordingly.
- How do you prefer to edit the file? How fast do you want your developments cycle to be with respect to the UI?

For the first point, this is a simple preferences. For a given addin it may make sense to simply put the buttons and other access on an existing tab (Developer and Data are popular!) and provide that level of access. For an addin that has a dedicated purposed independent of other Excel features, it starts to make sense to add your own tab exclusively for your addin. THis is good for helping your users find your features. It can also be more consistent in terms of keyboard shortcuts. If you are going to modify an existing tab, be abolustley certain that you verify that the keyboard shortcuts work as expected. There is nothing worse than having an addin break the ALT+A+R+Y shortcut which is supposed to reapply an autofilter. It is not fun when that shortcut becomes ALT+A+R+Y2. Seriously?

For the second point, you will need to consider the average user and their expectations. Keep in mind that the default Excel Ribbon includes a number of locations where user input is collected nad used beyond a simple button. This includes things like some number input (font size, page layout) and other drop downs. There is a willingness for Excel users to ues these features where it make sense. For what it's worht, from the Excel VBA point of view, it is much simpler to not try nad collect user input. This can be done (TODO: add examples), but the effort here is typically not worht the user experience. If you choose to go this route, I would highly recommend using drop downs and other inputs that provide some automatic filterng of user input. Trying to validate user input off the Ribbon is a pain and does not provide a good experience. Having siad that, if you are designing for power users, you can build a very slick interface in the Ribbon that is unmatched.

The final point gets down to the nitty gritty of actually editing the Ribbon. The problem is that the Ribbon is defined in a file inside your XLAM file and is not editable from any part of the VBE or Exce interface. This means that it is a real pain to edit the Ribbon definition in the same way that you can eidt the other VBA code. I have typically taken the approach of using a button on the Ribbon to launch a form that exists in VBA. That form can then be edited without having to touch the Ribbon definiont. This sounds tribial, but it can make a huge difference if you are designing an addin that has a lot of possible interactivity; it is very difficult to edit the Ribbon in real time. Having said that, there is one addin that makes this process much more manageable. It is from Andy Pope (TODO: add link) and works great for building out the interface. Even using that addin, it is a pian to add the callback necessary to tie the Ribbon to VBA. Don't be dissuaded from creating a nice Ribbon UI, but realize that it takes time and effort and attention to detail to properly detail out the Ribbon UI aspects.

#### editing the Ribbon

Note that the Ribbon is defined in an XML file inside your XLAM file. Remember that an XLAM file is simply a ZIP file of a bunch of different folders. By default, the Ribbon definition is not included and you must add the fodler and file. To do this, simple create the `customUi` folder and then create a XXX XML file inside there. This file will define the speciif changes you are making to the RIbbon.

#### callbacks

ONce you hav the Ribbon XML set up, you will be defining callbacks that need to actually exist in the VBA code. I always like to create a `Ribbon` module in the XLAM file which is solely responsible for callbacks. This is nice for larger addins with a large number of callbacks because it provides a isngle place. It also avoids debugging errors later when you accidentally put some critical code into a callback and forgot to check that out.

The callbacks take an odd signature. I always use Andy Pope's addin or copy a previous one. I have very seldom used the parameters in the callback for accessing the Ribbon information. My approach has always been to avoid extra interactivity with the ribbon. I have done it before, and it works, but the problem is that it is just not intuitive to do it that way. It is much easier to add a keyboard shortcut which shows a USerForm than to attempt to get the user to focus on the Ribbon (using the keyboard or mouse) and then provide the best info.
