## declaring and setting variables

One of the core tasks when programming via VBA is working with variables.  Variables encompass a couple of different topics which makes sense since they are one of two core areas of VBA alongside control structures.  That is, your programming exists of two possible categories: variables and control structures.  Variables are made of the variables that you will need to delcare and set to make your program work while also including all of the various aspects of the Excel object model.  The object model is made of a significant number of variables (e.g. cell value for each cell) and a handful of Subs and Functions.  The variables that you declare and use will look very similar to the object that the Excel model is using.  There are also a large number of variables that you will create which exist to guide your own control structure or to encompass the algorithms that you need to execute.

To fully work with variables, it helps to split the topic into two areas: declaring variables and setting variables.  These two topics are quite simple when it comes time to type out the commands, but variable declaration adn setting is at the core of planning how a program will work.  The variable declaration will directly shape how the control strcutures will work.  The two go hand in hand and are equally important.

### Declaring Variables

Decalring vairables is a straight forward tasks.  VBA offers a simple command to declare a new variable: `Dim`.  Note that you can technically use a vriable before declaring it, but you should really avaoid htis practice.  It leads to the potential to create all sorts of bugs later.  Just don't do it.  To better avoid this, setting hte flag in teh settings (TODO: add a picture of that).

When decalring a vairable, there are two compoentns to it: variable name and variable type.  Variable name is wholly your decision with only a couple of constraints.  You are not allowed to duplicate the name of an internal comannd, and you shoudl go to some lenght ot avoid using the same name as an Excel object model name.  Beware that naming a variable ahs certain concentions, but theese do not have any effect on the program execution.  The main concern with names is that they will directly affect your ability to work with and maintain your code.  Naming things is hard.  Pick a strategy that works for you and your coworkers and get on it with it.  There is no single answer here about how to name things.

The second part of the puzzle is to declare the type of the variable.  This is THE core part of variables.  When declaring a vairable, you are essentially deciding if the tpye should be the generic `Variant` or if you should actualyl declare a tpye.  Note that there are times when you have ot use Variant, but in general, you should use the most speciifc tpye that is possible.  These tpyes can either draw from VBA or from the Object Model, or from your own created types.  When thinking of variable types, tehre are two major groups of types:

- Vlaue types = a number, string, or boolean
- Reference types = objects

### Setting variables

Setting a variable is quite straight forward.  The rule is: for reference tpyes, you must use `Set`, for value types, you must not.

The real task then is to determine whether or not you are workign wtih a refernece type.  The rule here is: if you are workign with an object, it is a refernece type.  If you are working with a value (number, stirng, bool), then you are working with a value.  Another approach, if you intend to use a `.` to call out some property of your variable, then it is a reference type and requires `Set`.  The one odd excepipon here is arrays: they are declared without using Set.

### Using Variables

It seems somewhat obvious that you would want ot use a variable after declaring and setting it.  This is generally alwayas the case (why else would you create the variable).  To that end, there are a pair of ways to use variables depending on whetehr it is a reference or value type.  The easier one to understand is the value tpye where you simply ues the variable as is the same as would appear in a mathematical expression.  The more complicated example comes with reference types where the variable stores a reference to another object.  These variables have the ability to access either a property of the type or the default `Value` of the type.  This distinction adn the overall distinction between reference and value can become incredibly confusing with the Excel Object Model since so many properties of objects reduce to value types.  An example is the value of a `Range` which will hold some numbre or string or Error depending on what the cell contains.

When accessing a proprety of the obejct, you will use the `.` and find the property by name.  In this way, you can chain together a series of comamdns to access the properties of objects.  It is oftentimes the case that the property is itself anotehr object hwich makes it possible to use another `.` to keep going.  If you are using the VBE and properly delcaring your variables, the VBE will work to provide helpful suggestions of waht may be possible to use next (this is called Intellisense).  The one pitful to Intellisense is when the return from a given property can be Variant or a combination of possible results. When this happens, Intellisense will not offer any suggestions and you are left guessing whether or not the command exsits.  This is where it can be quite helpful to do one of two things:

- Create a new variable with the tpye that you know the object will have and Set that reference before using it. This "cheats" and tells Intellisense exactly twhat you expect to exist.
- Read through the documentation and gain an understanding of what ypes are possible and just use them.  There is no rule that the type must be suggested by Intellisense for it to be valid.

In general, I take a combination of those two approaches often.  If I expect to use the vriable a njmber of times, I will go with the new variable route to avoid guessing properties later.  If I only need the variable once or am copying code from somewehre else (and know it works), I will just go with the code as is without Intellisense.  The one upside of creating new variables is that it forces you to be more explitcit with your declarations.  It also clearly shows your intent to other developers thta may see your code later.  Finally, there is nothing worse than missing a typo that Intellisense didn't catch and having that be a shwo stopping bug at some poinit.

I mentioned it above, but it is worht digging into the default `Value` property a little more. This can be a source of confusiojn because very often, you will accidentally use the name of a variable wiitout calling for a property.  In other programming languages, this will result in a compile time or runtime error that is thrown because of the bad call.  In VBA, your code will run and even worse will return somethign from teh object that may not be what oyu want.  When this happens, it can be incredibly diffciult to track down the soruce of the error.  To avoid this, you could never use the variable name as a shortcut ot the `.Value` property.  In practice this is a pain to manage and I will often mix and match whether or not Value is called.  Sometimes, I am tired of typing out Value and just let the default work.  Other times, I am being very diligent about calling evertyhing explicitly to avoid some unforeseen error later.  You will find that this comes down to your own preference and hte preferences of others working on your code.
