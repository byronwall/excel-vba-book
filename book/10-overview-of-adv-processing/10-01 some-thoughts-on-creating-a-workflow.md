## some thoughts on creating a workflow

If you are sitting down to create an advanced workflow, there are a handful of things to consider. The list that follows is not complete nor is it meant to include items that are always relevant. The problem with these lists is that with a general programming environmetn like Excel, it's impossible to describe everything to consider. HAving said that, I have built tons of these workflows and can comment on a handful of things that nearly always come up. The first item to touch on is the general structure/outline of a VBA workflow. This breakdown seems to always hold true.

Your VBA workflow will contain steps or sub steps that roughly be described as:

- Inputs
- Intermediate results
- Outputs

If your workflow is advnaced enough to include a number of sub steps built from other steps, then you are likely to find that this breakdown applies within and across levels of your workflow. That is, the outputs of one step may very well be the inputs to another step. The intermediate result from one action will be the input for another.

When thinking in terms of these categories, there is a useful distinction to make that is somewhat unique to Excel programming: do your inputs and outputs exist in the Excel spreadsheet or only in the VBA code? This distinction is meaningful because it helps you think about how much of your workflow is the automation of otherwise human tasks (which could still be done by a human) vs. steps that are purely programmatic and could not be replicated by a human. Where this distinction is most likely to show up is when you are deciding where and how to perform a calculations. In theory, all of the Excel spreadsheet could be done in VBA via the `WorksheetFunction` object. Doing everything in VBA defeeats a large part of the benefit that comes from programmign with VBA. It's easy to lose sight of this when you see a clean code-only solution to a problem, but realize that the greatest benefit to programmign alongside Excel is that you have a powerful, human readable scratch pad that lives alongisde your VBA.

As a comment, I have seen incredibly complicated workflows that involved detailed calculations of arrays that were donely exclusively in VBA. The math was fine and the results were generally useful. The problem was that there was no way to spot check a given result without debugging code. This makes it nearly impossibly for someone without VBA expereicne to validate your work. It also provides you job security, but ideally you'd gain security by other means.

A better marriage of VBA and Excel is to utilize Excel for all of the tasks it's great at: calculation, visual outputs, charting, page layouts and printing, and also the deep data oriented features (sorting, filtering, etc). Where VBA comes in handy, is wiring together all of these items into a coherent package that runs more efficiently than anything that a human alone could do. The best workflows typically take a very simply underlying spreadsheet and apply to a large number of items. In this way, you are able to spot check a single result, verify the formulas, and investigate an interesting result. You are also free to just hit go and have 10,000+ reulsts streamed into a table for consumption. IF you find yourself looking for all sorts of tricks to avoid using the underlying Excel model for your programming, I'd strongly encourage to just switch to a fully programmatic language that does not have the Excel UI. You will save yourself a ton of headache. If you are only aware of VBA and lookign to push the envelope in terms of perofmrance, then that's an OK place to be. Just realize that there are better alternatives to Excel for high performance computing.
