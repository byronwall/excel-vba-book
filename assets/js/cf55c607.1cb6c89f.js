"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[7387],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return d}});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=o.createContext({}),c=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=c(e.components);return o.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),h=c(n),d=r,f=h["".concat(s,".").concat(d)]||h[d]||p[d]||a;return n?o.createElement(f,i(i({ref:t},u),{},{components:n})):o.createElement(f,i({ref:t},u))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var c=2;c<a;c++)i[c]=n[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}h.displayName="MDXCreateElement"},4393:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return u},default:function(){return h}});var o=n(7462),r=n(3366),a=(n(7294),n(3905)),i=["components"],l={},s=void 0,c={unversionedId:"The-Application-object/09-03 Controlling-events-and-visuals",id:"The-Application-object/09-03 Controlling-events-and-visuals",title:"09-03 Controlling-events-and-visuals",description:"Controlling events and visuals",source:"@site/docs/09-The-Application-object/09-03 Controlling-events-and-visuals.md",sourceDirName:"09-The-Application-object",slug:"/The-Application-object/09-03 Controlling-events-and-visuals",permalink:"/docs/The-Application-object/09-03 Controlling-events-and-visuals",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/09-The-Application-object/09-03 Controlling-events-and-visuals.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"09-02 Controlling-calculations",permalink:"/docs/The-Application-object/09-02 Controlling-calculations"},next:{title:"09-04 Controlling-the-StatusBar",permalink:"/docs/The-Application-object/09-04 Controlling-the-StatusBar"}},u=[{value:"Controlling events and visuals",id:"controlling-events-and-visuals",children:[{value:"ScreenUpdating",id:"screenupdating",children:[],level:3},{value:"EnableEvents",id:"enableevents",children:[],level:3}],level:2}],p={toc:u};function h(e){var t=e.components,n=(0,r.Z)(e,i);return(0,a.kt)("wrapper",(0,o.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"controlling-events-and-visuals"},"Controlling events and visuals"),(0,a.kt)("p",null,"THe previous section focused on controlling calculations, generally for the sake of performance. When seeking better performances, there are two other changes that are commonly made. They rely on disable the screen updating also disabling events. The former is a pretty tame change and is a no brainer if you want performance. There are very few downsides to disabling the screen. Disabling events can give a big boost in performances also, but there are a couple more risks involved. In addition to performance, there are other times where you need to disable events in order for your code to work."),(0,a.kt)("p",null,"The most common code for performances is repated here for clarity:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vba"},"Application.CalculationMode = xlManual\nApplication.ScreenUpdating = False\nApplication.EnabledEvents = False\n\nApplication.EnabledEvents = True\nApplication.ScreenUpdating = True\nApplication.CalculationMode = xlAutomatic\n")),(0,a.kt)("p",null,"What does that code do? Again, it forces calculation to manual mode, the screen to not update, and events to not fire."),(0,a.kt)("h3",{id:"screenupdating"},"ScreenUpdating"),(0,a.kt)("p",null,"Screen updating is one of those things that seems fairly silly if you are coming from another programming environment. In the vast majority of other programming settings, it is very uncommon for all of your changes to produce an immediate visual result. ON the one hand, this is doccifult and on the other, it is awful for performance. Exel takes the opposite approach since it is a user focused GUI that offers a scripting environment for uaotmatiojn. The default in Excel is that all of your commands will trigger the normal render and refresh that would have occurred had you manually made the change. IN practice, this can often produce a very cool effect where the commuter is quite literally doing all of the work for the user. once you get over the appeal of this, you will quickly be left with the question of: how much \u0192aster will my code be if I do not process all of these visual updates? The answer: much faster."),(0,a.kt)("p",null,"There are very few risks to disabling the screen. The biggest risk is that you forget to enabled it again (usually because of an error) and then your usre will get odd behavior. In a lot of case, Excel will actually enable the screen anyways so the actual risk here is minimal."),(0,a.kt)("p",null,'The only real reason to leave the screen active is in the case where your automation can ataxy be usefully reviewed by the user. In that case, you may consider leaving the scren active so that the user can "watch" what is happening. Some users like to see what the code is doing.'),(0,a.kt)("h3",{id:"enableevents"},"EnableEvents"),(0,a.kt)("p",null,"The more aggressive option in this chapter is to disable events form firing. This has the ffect of inmprpving performances because your code will be able to skip a number of potentially lsow steps. The downside f this approach is hat sometimes you need events to fire in order to achieve a desired result. This is especially the case if you wrote the event handlers."),(0,a.kt)("p",null,"For events, there is one extra considering for when yu might disable them. If you possibly making changes to the Workbook or Worksheet in an event, you will likely need to disable events while you make your changes. THe reason for this is to prevent an endless loop of your event handler processing the change you jut made. This is only relevant for a handful of event types (Selection and Change are common) but it happens to be the case that this is a problem on the most commonly used event handlers."),(0,a.kt)("p",null,"TODO: add an example of a full event handler that disables event handling"))}h.isMDXComponent=!0}}]);