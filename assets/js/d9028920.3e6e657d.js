"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[8797],{3905:function(e,t,o){o.d(t,{Zo:function(){return u},kt:function(){return d}});var n=o(7294);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,n,a=function(e,t){if(null==e)return{};var o,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var l=n.createContext({}),c=function(e){var t=n.useContext(l),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},u=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var o=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(o),d=a,f=p["".concat(l,".").concat(d)]||p[d]||h[d]||r;return o?n.createElement(f,i(i({ref:t},u),{},{components:o})):n.createElement(f,i({ref:t},u))}));function d(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=o.length,i=new Array(r);i[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,i[1]=s;for(var c=2;c<r;c++)i[c]=o[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,o)}p.displayName="MDXCreateElement"},2794:function(e,t,o){o.r(t),o.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return u},default:function(){return p}});var n=o(7462),a=o(3366),r=(o(7294),o(3905)),i=["components"],s={},l=void 0,c={unversionedId:"overview-of-events/11-02 specific-events",id:"overview-of-events/11-02 specific-events",title:"11-02 specific-events",description:"specific events",source:"@site/docs/11-overview-of-events/11-02 specific-events.md",sourceDirName:"11-overview-of-events",slug:"/overview-of-events/11-02 specific-events",permalink:"/excel-vba-book/docs/overview-of-events/11-02 specific-events",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/11-overview-of-events/11-02 specific-events.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"11-01 common-events",permalink:"/excel-vba-book/docs/overview-of-events/11-01 common-events"},next:{title:"11-03 common-patterns",permalink:"/excel-vba-book/docs/overview-of-events/11-03 common-patterns"}},u=[{value:"specific events",id:"specific-events",children:[{value:"Worksheet",id:"worksheet",children:[],level:3},{value:"Workbooks",id:"workbooks",children:[],level:3},{value:"Application",id:"application",children:[],level:3}],level:2}],h={toc:u};function p(e){var t=e.components,o=(0,a.Z)(e,i);return(0,r.kt)("wrapper",(0,n.Z)({},h,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"specific-events"},"specific events"),(0,r.kt)("p",null,"For actual event handling code, it makes most sense to take a look at the specific events that can occur and show some techniques for handling them."),(0,r.kt)("h3",{id:"worksheet"},"Worksheet"),(0,r.kt)("p",null,"THe Worksheet hsa a number of events which are commonly used. These include:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Changed"),(0,r.kt)("li",{parentName:"ul"},"SelectionChanged"),(0,r.kt)("li",{parentName:"ul"},"Activate")),(0,r.kt)("p",null,"These events roughly correspond to their name and are easy enough to handle. The idea with these is that you have a specific worksheet that you want to monitor for a specific event. In that case, you add the event using the VBE and then add the handling code."),(0,r.kt)("p",null,"The most common approaches for using these events is to track what the user is doing and then provide some additional functionality based on their actions. There are a number of reasons that you might want to respond to their input:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'Advanced usability where you allow the act of selecting a cell or cells to determine that some macro should run. You could imagine on a certain sheet that selecting a new cell may mean "please load more data about this row" and the VBA responds accordingly.'),(0,r.kt)("li",{parentName:"ul"},"Validation of user input. It is common to watch what the user is changing and then determine if that change is allowed or not based on specific rules."),(0,r.kt)("li",{parentName:"ul"},"Starting a new action with some user input. I have previously used editing a cell to trigger a goal seek on that cell. This was quite nice because the VBA would undo my edit and then goal seek the previous cell to a new value based on its formula. This provided a very slick means of trigger goal seek without having to collect further user input."),(0,r.kt)("li",{parentName:"ul"},"Refreshing some display. It's possible you set calculations to manual and then force a recalculate each itme the Worksheet comes into focus.")),(0,r.kt)("p",null,"For the Worksheet, the typical flow is that you will create events at the Worksheet level only if you know than you will only want the code for a single Worksheet (or you are willing to duplicate it across Worksheets). If you want to have the same code run for ",(0,r.kt)("em",{parentName:"p"},"all")," worksheets, you should look at the Workbook events which provide better views of the entire Workbook."),(0,r.kt)("p",null,"For some examples here, I will show you how to do the goal seek business along with a separate event which watches user Selection and then processes the cells accordingly."),(0,r.kt)("p",null,"TODO: add the code and description for the Goal Seek event"),(0,r.kt)("p",null,"TODO: add the code nad desc for some event which activates on Select"),(0,r.kt)("h3",{id:"workbooks"},"Workbooks"),(0,r.kt)("p",null,"For Workbooks, you have a lot of the same events as for a Worksheet. These events take the same parameters (TODO: is that right?) but allow you to watch for that event across all Worksheets in a Workbook. Depending on what you are watching for, this either makes perfect sense or is a real burden with false events that are not interesting. You will hav eot determine the proper scope for your events depending on what you need them to do. There are not fast rules here. The summary of possibly events then includes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Changed"),(0,r.kt)("li",{parentName:"ul"},"SelectionCHange"),(0,r.kt)("li",{parentName:"ul"},"Activated"),(0,r.kt)("li",{parentName:"ul"},"Opened"),(0,r.kt)("li",{parentName:"ul"},"BeforeSave"),(0,r.kt)("li",{parentName:"ul"},"Other Save events"),(0,r.kt)("li",{parentName:"ul"},"Closing")),(0,r.kt)("p",null,"TODO: add some callback parameters above (and verify names)"),(0,r.kt)("p",null,"TODO: review other events to see what may be useful"),(0,r.kt)("p",null,"These events are similar to Worksheets except that they give you additional hooks that only make sense for a Workbook, specifically related to Saving, Opening, and Closing. There events can be quite useful if you want to do some amount of processing before the file is saved. One common approach I have taken is to delete extraneous data from a workflow spreadsheet to reduce the size and save time for a file. This can be used to great effect if your processing spreadsheet is generally pretty lean without the data it processes. You could also use this to delete a Chart that is large and having a big impact on file size. Once the file is opened, you can then use VBA to recreate the chart."),(0,r.kt)("p",null,"IN some cases, these events are used for that type of example where it seems like a lot of work to save some amount of hassle. Oftentimes, this is the case. You can spend a lot of time with event code to make it do exactly what you rwant. Sometimes for a user focused spreadsheet, however, this is the level of detail than tis required to ensure that everything will work every time for everyone."),(0,r.kt)("p",null,"TODO: add an example and desc for a data removal VBA"),(0,r.kt)("h3",{id:"application"},"Application"),(0,r.kt)("p",null,"There are also a couple of events that exist at the Application level. These include:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"OnWait"),(0,r.kt)("li",{parentName:"ul"},"TODO: any others?")),(0,r.kt)("p",null,"Application.OnWait can be used to trigger an event at some point in the future. This can then be used to trigger a block of code which runs at an interval by having the triggered code start a new event in the future. In this ways, you can use VBA to start a timer which executes every so often."),(0,r.kt)("p",null,"TODO: add the OnWait code for a timer"),(0,r.kt)("p",null,"TODO: find another examples"))}p.isMDXComponent=!0}}]);