"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[7383],{3905:function(e,t,o){o.d(t,{Zo:function(){return c},kt:function(){return m}});var n=o(7294);function r(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function a(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function l(e,t){if(null==e)return{};var o,n,r=function(e,t){if(null==e)return{};var o,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)o=a[n],t.indexOf(o)>=0||(r[o]=e[o]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)o=a[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}var s=n.createContext({}),u=function(e){var t=n.useContext(s),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},c=function(e){var t=u(e.components);return n.createElement(s.Provider,{value:t},e.children)},f={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var o=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=u(o),m=r,d=p["".concat(s,".").concat(m)]||p[m]||f[m]||a;return o?n.createElement(d,i(i({ref:t},c),{},{components:o})):n.createElement(d,i({ref:t},c))}));function m(e,t){var o=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=o.length,i=new Array(a);i[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var u=2;u<a;u++)i[u]=o[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,o)}p.displayName="MDXCreateElement"},9441:function(e,t,o){o.r(t),o.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return u},toc:function(){return c},default:function(){return p}});var n=o(7462),r=o(3366),a=(o(7294),o(3905)),i=["components"],l={},s=void 0,u={unversionedId:"overview-of-UDFs/13-06 complicated-UDFS",id:"overview-of-UDFs/13-06 complicated-UDFS",title:"13-06 complicated-UDFS",description:"complicated UDFS",source:"@site/docs/13-overview-of-UDFs/13-06 complicated-UDFS.md",sourceDirName:"13-overview-of-UDFs",slug:"/overview-of-UDFs/13-06 complicated-UDFS",permalink:"/excel-vba-book/docs/overview-of-UDFs/13-06 complicated-UDFS",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/13-overview-of-UDFs/13-06 complicated-UDFS.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"13-05 managing-the-parameters-and-types-of-UDFs",permalink:"/excel-vba-book/docs/overview-of-UDFs/13-05 managing-the-parameters-and-types-of-UDFs"},next:{title:"13-07 debugging-UDFs",permalink:"/excel-vba-book/docs/overview-of-UDFs/13-07 debugging-UDFs"}},c=[{value:"complicated UDFS",id:"complicated-udfs",children:[],level:2}],f={toc:c};function p(e){var t=e.components,o=(0,r.Z)(e,i);return(0,a.kt)("wrapper",(0,n.Z)({},f,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"complicated-udfs"},"complicated UDFS"),(0,a.kt)("p",null,"One of the great advantages of UDFs is that you give you full access to all of VBA while still executing within the spreadsheet. There are some limits to this power, but, in general, you able to do some very powerful stuff in the same interface that you normally do a ",(0,a.kt)("inlineCode",{parentName:"p"},"SUM"),". To take advantage of this power, you need to be aware that these things are possible and then consider taking a shot at it."),(0,a.kt)("p",null,"Some of the more complicate areas where you will want to write a UDF include:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Using Range information from cells not related to the parameters"),(0,a.kt)("li",{parentName:"ul"},"Accessing the FileSystem")),(0,a.kt)("p",null,"Related to the Range, you have full access to all of the Workbooks and Worksheets that are available in VBA. This means that you can combine a large amount of data in VBA and then output it to a UDF return. Where this becomes useful if when you want to look at the metadata of a Range of Worksheet. Until Excel 2013, most of this information was simply not available without VBA. Post 2013, you are able to use the ",(0,a.kt)("inlineCode",{parentName:"p"},"CELL")," function (TODO: is this right). Some of the more useful things here are to use the formatting of a cell (e.g. return the background color) or the display value (i.e. ",(0,a.kt)("inlineCode",{parentName:"p"},"Range.Text"),"). These UDFs can be great for either long term usage or for a quick throwaway to get information into the spreadsheet. When doing the latter, there is essentially no difference between using a UDF and running through the cells using a normal Sub. The main reason you might use a UDF is if the cells you want to target are not easy to identify in VBA."),(0,a.kt)("p",null,"Other possible UDFs allow you to access the file system and possibly return information from there. ONe example would be to return the size of a file in KB given a file name. Really, you could go get any information you want. Again, this type of UDF can be easily done as a UDF or just as a Sub that runs through a Range as an input."),(0,a.kt)("p",null,"When considering whether or not to use a UDF or a Sub, consider the following:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"A UDF will update automatically when the parameters to it change (or always if marked as Volatile). This is the key differentiator."),(0,a.kt)("li",{parentName:"ul"},"A Sub can run without embedding itself into a spreadsheet. This is key if you need to save the spreadsheet with your information without a link to your code. This is a moot point if your UDF lives in an XLSM file but starts to matter for an addin. You can also do a copy/paste values if you want to remove the UDF.")),(0,a.kt)("p",null,"TODO: consider adding more here or refining this section"))}p.isMDXComponent=!0}}]);