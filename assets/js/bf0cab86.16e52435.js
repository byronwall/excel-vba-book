"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[4375],{3905:function(e,o,r){r.d(o,{Zo:function(){return c},kt:function(){return f}});var n=r(7294);function t(e,o,r){return o in e?Object.defineProperty(e,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[o]=r,e}function a(e,o){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);o&&(n=n.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var o=1;o<arguments.length;o++){var r=null!=arguments[o]?arguments[o]:{};o%2?a(Object(r),!0).forEach((function(o){t(e,o,r[o])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))}))}return e}function i(e,o){if(null==e)return{};var r,n,t=function(e,o){if(null==e)return{};var r,n,t={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],o.indexOf(r)>=0||(t[r]=e[r]);return t}(e,o);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],o.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}var s=n.createContext({}),u=function(e){var o=n.useContext(s),r=o;return e&&(r="function"==typeof e?e(o):l(l({},o),e)),r},c=function(e){var o=u(e.components);return n.createElement(s.Provider,{value:o},e.children)},m={inlineCode:"code",wrapper:function(e){var o=e.children;return n.createElement(n.Fragment,{},o)}},d=n.forwardRef((function(e,o){var r=e.components,t=e.mdxType,a=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=u(r),f=t,p=d["".concat(s,".").concat(f)]||d[f]||m[f]||a;return r?n.createElement(p,l(l({ref:o},c),{},{components:r})):n.createElement(p,l({ref:o},c))}));function f(e,o){var r=arguments,t=o&&o.mdxType;if("string"==typeof e||t){var a=r.length,l=new Array(a);l[0]=d;var i={};for(var s in o)hasOwnProperty.call(o,s)&&(i[s]=o[s]);i.originalType=e,i.mdxType="string"==typeof e?e:t,l[1]=i;for(var u=2;u<a;u++)l[u]=r[u];return n.createElement.apply(null,l)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},6109:function(e,o,r){r.r(o),r.d(o,{frontMatter:function(){return i},contentTitle:function(){return s},metadata:function(){return u},toc:function(){return c},default:function(){return d}});var n=r(7462),t=r(3366),a=(r(7294),r(3905)),l=["components"],i={},s=void 0,u={unversionedId:"overview-of-values-and-formulas/05-07 Colorizemd",id:"overview-of-values-and-formulas/05-07 Colorizemd",title:"05-07 Colorizemd",description:"Colorize.md",source:"@site/docs/05-overview-of-values-and-formulas/05-07 Colorizemd.md",sourceDirName:"05-overview-of-values-and-formulas",slug:"/overview-of-values-and-formulas/05-07 Colorizemd",permalink:"/excel-vba-book/docs/overview-of-values-and-formulas/05-07 Colorizemd",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/05-overview-of-values-and-formulas/05-07 Colorizemd.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"05-06 CombineCellsmd",permalink:"/excel-vba-book/docs/overview-of-values-and-formulas/05-06 CombineCellsmd"},next:{title:"05-07 ConvertToNumbermd",permalink:"/excel-vba-book/docs/overview-of-values-and-formulas/05-07 ConvertToNumbermd"}},c=[{value:"Colorize.md",id:"colorizemd",children:[],level:2}],m={toc:c};function d(e){var o=e.components,r=(0,t.Z)(e,l);return(0,a.kt)("wrapper",(0,n.Z)({},m,r,{components:o,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"colorizemd"},"Colorize.md"),(0,a.kt)("p",null,"The Sub below makes it possible to applied a banded row coloring based on changing values in the rows. That is, it looks at the value in a given cell and compares it to the cell above. If the value has changed, it applies the next color. If the same, it will apply the same color as the row above. This gives a simple demonstration of how it's possible to create simple or complicated formatting rules with VBA."),(0,a.kt)("p",null,"TODO: clean up the code below to simplify the process and show only the core bits needed."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-vb"},'Public Sub Colorize()\n\n    Dim targetRange As Range\n    On Error GoTo errHandler\n    Set targetRange = GetInputOrSelection("Select range to color")\n    Dim lastRow As Long\n    lastRow = targetRange.Rows.Count\n    Dim interiorColor As Long\n    interiorColor = RGB(200, 200, 200)\n\n    Dim sameColorForLikeValues As VbMsgBoxResult\n    sameColorForLikeValues = MsgBox("Do you want to keep duplicate values the same color?", vbYesNo)\n\n    If sameColorForLikeValues = vbNo Then\n\n        Dim i As Long\n        For i = 1 To lastRow\n            If i Mod 2 = 0 Then\n                targetRange.Rows(i).Interior.Color = interiorColor\n            Else: targetRange.Rows(i).Interior.ColorIndex = xlNone\n            End If\n        Next\n    End If\n\n\n    If sameColorForLikeValues = vbYes Then\n        Dim flipFlag As Boolean\n        For i = 2 To lastRow\n            If targetRange.Cells(i, 1) <> targetRange.Cells(i - 1, 1) Then flipFlag = Not flipFlag\n            If flipFlag Then\n                targetRange.Rows(i).Interior.Color = interiorColor\n            Else: targetRange.Rows(i).Interior.ColorIndex = xlNone\n            End If\n        Next\n    End If\n    Exit Sub\nerrHandler:\n    MsgBox "No Range Selected!"\nEnd Sub\n')))}d.isMDXComponent=!0}}]);